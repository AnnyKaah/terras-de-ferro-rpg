<!-- h:\Meu Drive\2026\2. projetos\rpg-terras-de-ferro\index.html -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terras de Ferro â€” RPG Dark Fantasy</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âš”ï¸</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- PeerJS para Multiplayer -->
    <script src="https://unpkg.com/peerjs@1.5.1/dist/peerjs.min.js"></script>
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
</head>
<body>
    <!-- Overlays de Efeito Global -->
    <div id="transition-overlay"></div>
    <div id="fog-overlay"></div>
    <div id="damage-overlay"></div>

    <!-- Container de NotificaÃ§Ãµes (Toasts) -->
    <div id="toast-container"></div>

    <!-- ============================================
         TELA 1: INÃCIO (HERO PAGE)
         ============================================ -->
    <div id="start-screen" class="screen active">
        <!-- Fundo com Parallax e Montanhas -->
        <div class="hero-bg">
            <div class="parallax-layer layer-1"></div>
            <div class="parallax-layer layer-2"></div>
            <div class="parallax-layer layer-3"></div>
            <div class="parallax-layer layer-4"></div>
        </div>
        
        <div class="start-container">
            <div class="title-glow">âš”ï¸</div>
            <h1 class="main-title">Terras de Ferro</h1>
            <p class="subtitle">Juramentos. Ferro. EscuridÃ£o.</p>
            
            <!-- Controles do Lobby -->
            <div class="lobby-controls">
                <button id="btn-host" class="btn-primary" onclick="game.hostGame()">
                    ğŸ‘‘ Criar Sala (Host)
                </button>
                
                <div class="lobby-input-group">
                    <input type="text" id="join-id-input" class="lobby-input" placeholder="ID da Sala">
                    <button id="btn-paste" class="btn-secondary" onclick="game.pasteRoomId()" title="Colar ID">
                        ğŸ“‹
                    </button>
                    <button id="btn-join" class="btn-secondary" onclick="game.joinGameUI()">
                        Unir-se
                    </button>
                </div>
                
                <button class="btn-secondary btn-solo" onclick="game.startOfflineGame()">
                    ğŸ® Jogar Solo
                </button>
            </div>
            
            <button class="btn-secondary" onclick="ui.showRules()">Como Jogar</button>
        </div>
    </div>

    <!-- ============================================
         TELA 2: REGRAS
         ============================================ -->
    <div id="rules-screen" class="screen">
        <div class="rules-container">
            <h2>ğŸ² Como Jogar</h2>
            <div class="rule-grid">
                <div class="rule-card">
                    <h3>ğŸ² A Rolagem</h3>
                    <p>Para realizar uma aÃ§Ã£o, o jogo calcula:</p>
                    <div class="formula-box">1d6 + Atributo + BÃ´nus</div>
                    <p class="formula-label">Este Ã© seu <strong>Valor de AÃ§Ã£o</strong></p>
                    <hr class="rule-divider">
                    <p>Ele Ã© comparado contra:</p>
                    <div class="formula-box challenge">2 Dados de 10 (2d10)</div>
                    <p class="formula-label">Estes sÃ£o os <strong>Dados de Desafio</strong></p>
                </div>
                <div class="rule-card">
                    <h3>ğŸ“Š O Veredito</h3>
                    <p>Compare seu <strong>Valor de AÃ§Ã£o</strong> com <strong>cada d10</strong> individualmente:</p>
                    <ul>
                        <li class="res-strong">âœ… <strong>Sucesso Forte</strong><br><small>Seu total Ã© MAIOR que os dois d10. VocÃª consegue o que queria.</small></li>
                        <li class="res-weak">âš ï¸ <strong>Sucesso Fraco</strong><br><small>Seu total Ã© MAIOR que apenas um d10. VocÃª consegue, mas paga um preÃ§o.</small></li>
                        <li class="res-fail">âŒ <strong>Falha</strong><br><small>Seu total Ã© MENOR que os dois. Algo ruim acontece.</small></li>
                    </ul>
                </div>
                <div class="rule-card">
                    <h3>ğŸ”¥ Recursos & Impulso</h3>
                    <ul class="resources-list">
                        <li><strong>â¤ï¸ SaÃºde / ğŸ§  EspÃ­rito:</strong> Se chegarem a 0, seu personagem enfrenta a morte ou a loucura.</li>
                        <li><strong>ğŸ”¥ Impulso:</strong> Ganhe fazendo movimentos com sucesso.</li>
                        <li><strong>âš¡ Queimar Impulso:</strong> Se seu Impulso for maior que um d10, vocÃª pode "queimÃ¡-lo" para anular aquele dado e melhorar seu resultado.</li>
                    </ul>
                </div>
            </div>
            <button class="btn-primary" onclick="ui.hideRules()">Entendi!</button>
        </div>
    </div>

    <!-- ============================================
         TELA 3: SELEÃ‡ÃƒO DE PERSONAGENS
         ============================================ -->
    <div id="character-screen" class="screen">
        <div class="char-select-container">
            <h2>Quem sÃ£o vocÃªs?</h2>
            
            <!-- Painel do Host (Multiplayer) -->
            <div id="host-info" style="display: none;" class="glass-panel info-panel">
                <p>ğŸ“¡ Compartilhe este ID com seu aliado:</p>
                <div class="lobby-input-group">
                    <input type="text" id="room-id-display" class="lobby-input" readonly value="...">
                    <button id="btn-copy" class="btn-secondary" onclick="multiplayer.copyRoomId()">
                        ğŸ“‹ Copiar
                    </button>
                </div>
                <p id="connection-status" style="margin-top: 10px; color: #aaa; font-style: italic;">
                    â³ Aguardando conexÃ£o do Jogador 2...
                </p>
            </div>

            <!-- Grid de Personagens (Injetado via JS) -->
            <div class="characters-grid"></div>

            <!-- Status da SeleÃ§Ã£o -->
            <div id="selection-status" class="selection-status"></div>
            
            <button id="undo-selection" class="btn-secondary" style="display: none;" onclick="game.undoCharacterSelection()">
                â†¶ Desfazer
            </button>
            <button id="leave-room" class="btn-secondary" onclick="game.requestLeaveGame()">
                ğŸšª Sair da Sala
            </button>
            <button id="confirm-chars" class="btn-primary" style="display: none;" disabled onclick="game.confirmCharacters()">
                âœ… Iniciar Juramento
            </button>
        </div>
    </div>

    <!-- ============================================
         TELA 4: SELEÃ‡ÃƒO DE ATIVOS
         ============================================ -->
    <div id="asset-screen" class="screen">
        <div class="char-select-container">
            <h2>Escolha seu Caminho</h2>
            <p style="text-align: center; color: #aaa; margin-bottom: 20px;">
                Cada herÃ³i comeÃ§a com um Ativo especial.
            </p>
            <div id="asset-grid" class="asset-grid"></div>
            <div id="asset-status" class="selection-status"></div>
            <button id="confirm-assets" class="btn-primary" style="display: none;" onclick="game.finishSetup()">
                ğŸ­ ComeÃ§ar Aventura
            </button>
        </div>
    </div>

    <!-- ============================================
         TELA 5: JOGO PRINCIPAL
         ============================================ -->
    <div id="game-screen" class="screen">
        <div class="game-layout">
            <!-- Sidebar (Status e Controles) -->
            <aside class="sidebar">
                <div class="party-info">
                    <h3>Aliados</h3>
                    <div id="char1-status" class="char-status"></div>
                    <div id="char2-status" class="char-status"></div>
                    <div id="bond-display" class="bond-display"></div>
                </div>
                
                <div class="progress-section">
                    <h4>Juramento de Ferro</h4>
                    <div class="progress-bar-container">
                        <div id="progress-bar" class="progress-bar"></div>
                    </div>
                    <p id="progress-text">0/10 Marcos</p>
                </div>

                <div class="controls">
                    <button class="btn-action" onclick="dice.showDiceRoller(game.currentPlayer, 'ferro')">ğŸ² Rolar</button>
                    <button class="btn-action" onclick="ui.showInventory()">ğŸ’ InventÃ¡rio</button>
                    <button class="btn-action" onclick="ui.showRestModal()">â›º Descansar</button>
                    <button class="btn-action danger" onclick="game.requestLeaveGame()">ğŸšª Sair da Sala</button>
                </div>
            </aside>

            <!-- ConteÃºdo da Cena -->
            <main class="main-content">
                <div id="scene-container" class="scene-container"></div>
                <div id="decision-container" class="decision-container"></div>
                <div id="log-container" class="log-container"></div>
            </main>
        </div>
    </div>

    <!-- ============================================
         TELA 6: GAME OVER
         ============================================ -->
    <div id="game-over-screen" class="screen">
        <div class="game-over-container">
            <div class="skull-icon">â˜ ï¸</div>
            <h2>Juramento Quebrado</h2>
            <p>Sua jornada termina aqui, nas frias Terras de Ferro.</p>
            <button class="btn-primary" onclick="game.restartCurrentScene()">ğŸ”„ Tentar Novamente</button>
            <button class="btn-secondary" onclick="game.returnToMenu()">ğŸ  Voltar ao Menu</button>
        </div>
    </div>

    <!-- ============================================
         MODAIS (Dados, InventÃ¡rio, Mapa)
         ============================================ -->
    
    <!-- Modal de Dados -->
    <div id="dice-modal" class="modal">
        <div class="modal-content dice-modal-content">
            <h3>ğŸ² Rolar os Dados</h3>
            <p id="dice-context">Teste de Atributo</p>
            
            <div class="dice-options">
                <button class="btn-dice" onclick="dice.roll(1)">
                    <span id="char1-name">Jogador 1</span>
                </button>
                <button class="btn-dice" onclick="dice.roll(2)">
                    <span id="char2-name">Jogador 2</span>
                </button>
            </div>

            <div class="modifiers">
                <button id="btn-use-bond" class="btn-mod" onclick="dice.useBond()">
                    â¤ï¸ LaÃ§o (+1)
                </button>
                <button id="btn-burn-momentum" class="btn-mod momentum" onclick="dice.burnMomentum()" disabled>
                    ğŸ”¥ Queimar Impulso
                </button>
            </div>

            <div id="dice-result" class="dice-result" style="display: none;"></div>
            
            <button class="btn-close" onclick="dice.closeModal()">Fechar</button>
        </div>
    </div>

    <!-- Modal de Descanso -->
    <div id="rest-modal" class="modal">
        <div class="modal-content">
            <h3>â›º Acampamento</h3>
            <div id="rest-content"></div>
            <button class="btn-close" onclick="ui.closeModal('rest-modal')">Fechar</button>
        </div>
    </div>

    <!-- Modal de ConfirmaÃ§Ã£o de SaÃ­da -->
    <div id="leave-confirm-modal" class="modal">
        <div class="modal-content" style="text-align: center;">
            <h3>âš ï¸ Sair da Sala?</h3>
            <p>VocÃª perderÃ¡ a conexÃ£o atual e voltarÃ¡ ao menu inicial.</p>
            <button class="btn-action danger" onclick="game.confirmLeaveGame()">Sim, Sair</button>
            <button class="btn-action" onclick="ui.closeModal('leave-confirm-modal')">Cancelar</button>
        </div>
    </div>

    <!-- Modal de InventÃ¡rio -->
    <div id="inventory-modal" class="modal">
        <div class="modal-content">
            <h3>ğŸ’ InventÃ¡rio</h3>
            <div id="inventory-content"></div>
            <button class="btn-close" onclick="ui.closeModal('inventory-modal')">Fechar</button>
        </div>
    </div>

    <!-- Modal de Mapa -->
    <div id="map-modal" class="modal">
        <div class="modal-content map-modal-content">
            <h3>ğŸ—ºï¸ Mapa das Terras de Ferro</h3>
            <div id="map-content"></div>
            <button class="btn-close" onclick="ui.closeModal('map-modal')">Fechar</button>
        </div>
    </div>

    <!-- ============================================
         SCRIPTS (Ordem de Carregamento)
         ============================================ -->
    <script src="js/data/items.js"></script>
    <script src="js/data/scenes.js"></script>
    <script src="js/core/state.js"></script>
    <script src="js/core/dice.js"></script>
    <script src="js/ui/ui.js"></script>
    <script src="js/multiplayer.js"></script>
    <script src="js/game.js"></script>
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js')
                .then(() => console.log('Service Worker registrado!'))
                .catch((err) => console.error('Erro no SW:', err));
        }
    </script>
</body>
</html>
